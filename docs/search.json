[
  {
    "objectID": "EDA.html",
    "href": "EDA.html",
    "title": "ST558 Final Project EDA - Lee Worthington",
    "section": "",
    "text": "The dataset used for this analysis is derived from the Behavioral Risk Factor Surveillance System (BRFSS) 2015, a health-related telephone survey conducted annually by the Centers for Disease Control and Prevention (CDC). The BRFSS collects data from over 400,000 Americans on health-related risk behaviors, chronic health conditions, and the use of preventative services.\nFor this project Ill focus on the diabetes_binary_health_indicators_BRFSS2015.csv file that contains 253680 survey responses, the main goal is to predict Diabetes_binary which has the below levels. - 0: No diabetes - 1: Prediabetes or diabetes\nThere are 21 potential predictors in the data, since I dont know anything about diabetes I will be using all of the predictors when modelling rather than making assumptions about what may be relevant\n\nHighBP: High blood pressure (N/Y)\nHighChol: High cholesterol (N/Y)\nCholCheck: Cholesterol check within the past five years (N/Y)\nBMI: Body mass index (numeric)\nSmoker: Smoker status (N/Y)\nStroke: History of stroke (N/Y)\nHeartDiseaseorAttack: Coronary heart disease or myocardial infarction (N/Y)\nPhysActivity: Physical activity in the past 30 days (N/Y)\nFruits: Consumption of fruits at least once per day (N/Y)\nVeggies: Consumption of vegetables at least once per day (N/Y)\nHvyAlcoholConsump: Heavy alcohol consumption (N/Y)\nAnyHealthcare: Access to healthcare coverage (N/Y)\nNoDocbcCost: Inability to see a doctor due to cost (N/Y)\nGenHlth: General health status (Excellent/VGood/Good/Fair/Poor)\nMentHlth: Days in the past 30 days when mental health was not good (numeric)\nPhysHlth: Days in the past 30 days when physical health was not good (numeric)\nDiffWalk: Difficulty walking or climbing stairs (N/Y)\nSex: Gender (F/M)\nAge: Age categories (18-24, 25-29, 30-34, 35-39, 40-44, 45-49, 50-54, 55-59, 60-64, 65-69, 70-74, 75-79, 80+)\nEducation: Education level (No School, Elem, Some HS, HS Grad, Some College, College Grad)\nIncome: Income categories (<$10k, $10-15k, $15-20k, $20-25k, $25-35k, $35-50k, $50-75k, >$75k)\n\n\n\n\nThe main goal of the EDA here is to get a better idea of the data and to spot potential relationships in the data, to hopefully build a model that can accurately predict diabetes based on the available predictors. Since most of the predictors are categorical and there are a large number of them, I will mainly focus on understanding the following in the EDA:\n\nUnderstanding the Distribution: Primarily how the distributions for each predictor vary based on having or not having diabetes, in order to identify potentially relevant predictors\nChecking Data Quality: ID any potential issues with the data, that may require adjustment. That being said my general approach is to not clean or remove data unless im certain its an error, which I cannot be with this data"
  },
  {
    "objectID": "EDA.html#print-summary-results",
    "href": "EDA.html#print-summary-results",
    "title": "ST558 Final Project EDA - Lee Worthington",
    "section": "Print summary results",
    "text": "Print summary results\n\nsummary(df)\n\n Diabetes_binary HighBP     HighChol   CholCheck       BMI        Smoker    \n No :218334      N:144851   N:146089   N:  9470   Min.   :12.00   N:141257  \n Pre: 35346      Y:108829   Y:107591   Y:244210   1st Qu.:24.00   Y:112423  \n Yes:     0                                       Median :27.00             \n                                                  Mean   :28.38             \n                                                  3rd Qu.:31.00             \n                                                  Max.   :98.00             \n                                                                            \n Stroke     HeartDiseaseorAttack PhysActivity Fruits     Veggies   \n N:243388   N:229787             N: 61760     N: 92782   N: 47839  \n Y: 10292   Y: 23893             Y:191920     Y:160898   Y:205841  \n                                                                   \n                                                                   \n                                                                   \n                                                                   \n                                                                   \n HvyAlcoholConsump AnyHealthcare NoDocbcCost  GenHlth         MentHlth     \n N:239424          N: 12417      N:232326    Exc  :45299   Min.   : 0.000  \n Y: 14256          Y:241263      Y: 21354    VGood:89084   1st Qu.: 0.000  \n                                             Good :75646   Median : 0.000  \n                                             Fair :31570   Mean   : 3.185  \n                                             Poor :12081   3rd Qu.: 2.000  \n                                                           Max.   :30.000  \n                                                                           \n    PhysHlth      DiffWalk   Sex             Age               Education     \n Min.   : 0.000   N:211005   F:141974   60-64  :33244   None/Kinder :   174  \n 1st Qu.: 0.000   Y: 42675   M:111706   65-69  :32194   Elem        :  4043  \n Median : 0.000                         55-59  :30832   Some HS     :  9478  \n Mean   : 4.242                         50-54  :26314   HS Grad     : 62750  \n 3rd Qu.: 3.000                         70-74  :23533   Some College: 69910  \n Max.   :30.000                         45-49  :19819   College Grad:107325  \n                                        (Other):87744                        \n     Income     \n >$75k  :90385  \n $50-75k:43219  \n $35-50k:36470  \n $25-35k:25883  \n $20-25k:20135  \n $15-20k:15994  \n (Other):21594  \n\n\n\nBased on the dataset descriptions and the data, these are the variables and types:\n\nDiabetes_binary: Factor (0: No diabetes, 1: Prediabetes or diabetes)\nHighBP: Factor (0: No, 1: Yes)\nHighChol: Factor (0: No, 1: Yes)\nCholCheck: Factor (0: No, 1: Yes)\nBMI: Numeric\nSmoker: Factor (0: No, 1: Yes)\nStroke: Factor (0: No, 1: Yes)\nHeartDiseaseorAttack: Factor (0: No, 1: Yes)\nPhysActivity: Factor (0: No, 1: Yes)\nFruits: Factor (0: No, 1: Yes)\nVeggies: Factor (0: No, 1: Yes)\nHvyAlcoholConsump: Factor (0: No, 1: Yes)\nAnyHealthcare: Factor (0: No, 1: Yes)\nNoDocbcCost: Factor (0: No, 1: Yes)\nGenHlth: Factor with 5 levels (1: Excellent, 2: Very good, 3: Good, 4: Fair, 5: Poor)\nMentHlth: Numeric\nPhysHlth: Numeric\nDiffWalk: Factor (0: No, 1: Yes)\nSex: Factor with 2 levels (0: Female, 1: Male)\nAge: Factor with 13 levels (1: 18-24, 2: 25-29, 3: 30-34, 4: 35-39, 5: 40-44, 6: 45-49, 7: 50-54, 8: 55-59, 9: 60-64, 10: 65-69, 11: 70-74, 12: 75-79, 13: 80 or older)\nEducation: Factor with 6 levels (1: Never attended school or only kindergarten, 2: Grades 1 through 8, 3: Grades 9 through 11, 4: Grade 12 or GED, 5: College 1 year to 3 years, 6: College 4 years or more)\nIncome: Factor with 8 levels (1: Less than $10,000, 2: $10,000 to less than $15,000, 3: $15,000 to less than $20,000, 4: $20,000 to less than $25,000, 5: $25,000 to less than $35,000, 6: $35,000 to less than $50,000, 7: $50,000 to less than $75,000, 8: $75,000 or more)\n\n\n\nSome notes\n\nIn the kraggle notes they say Diabetes_binary should have 3 levels (0 = no diabetes 1 = prediabetes 2 = diabetes), but there are no records with value = 2"
  },
  {
    "objectID": "EDA.html#code-for-plots",
    "href": "EDA.html#code-for-plots",
    "title": "ST558 Final Project EDA - Lee Worthington",
    "section": "Code for plots",
    "text": "Code for plots\n\n# plot pairs\n#GGally::ggpairs(df, columns = c(1, 2, 3, 4)) \n#GGally::ggpairs(df, columns = c(1, 5, 6, 7))\n#GGally::ggpairs(df, columns = c(1, 8, 9, 10))\n#GGally::ggpairs(df, columns = c(1, 11, 12, 13))\n#GGally::ggpairs(df, columns = c(1, 14, 15, 16))\n#GGally::ggpairs(df, columns = c(1, 17, 18, 19))\n# Mosts of these are ahrd to read and not very informative, use custom plots instead\n\n# Define different variable types\nfactor_vars_heatmap <- c(\n  \"HighBP\", \"HighChol\", \"CholCheck\", \"Smoker\", \"Stroke\", \"HeartDiseaseorAttack\",\n  \"PhysActivity\", \"Fruits\", \"Veggies\", \"HvyAlcoholConsump\", \"AnyHealthcare\",\n  \"NoDocbcCost\", \"DiffWalk\", \"Sex\"\n)\nfactor_vars_histogram <- c(\"GenHlth\", \"Age\", \"Education\", \"Income\")\nnumeric_vars <- c(\"BMI\", \"MentHlth\", \"PhysHlth\")\n\n# Function to generate heatmap for confusion matrix of factor variables\ngenerate_heatmap <- function(var) {\n  confusion <- table(df$Diabetes_binary, df[[var]])\n  confusion_melted <- melt(confusion)\n  confusion_melted$percentage <- confusion_melted$value / sum(confusion_melted$value) * 100\n  confusion_melted$label <- paste(comma(confusion_melted$value), sprintf(\"(%.1f%%)\", confusion_melted$percentage))\n  \n  ggplot(confusion_melted, aes(Var1, Var2, fill = value)) +\n    geom_tile(alpha = 0.5) +\n    geom_text(aes(label = label), color = \"black\") +\n    scale_fill_gradient(low = \"lightgreen\", high = \"darkgreen\") +\n    labs(title = paste(\"Confusion Matrix for\", var),\n         x = \"Diabetes_binary\",\n         y = var,\n         fill = \"Count\") +\n    theme_minimal() +\n    scale_x_discrete(labels = c(\"0\", \"1\")) +\n    scale_y_discrete(labels = c(\"0\", \"1\"))\n}\n\n# Function to generate histogram for numeric variables with log scale on x-axis\ngenerate_histogram_numeric <- function(var) {\n  ggplot(df, aes_string(x = var, fill = \"Diabetes_binary\")) +\n    geom_histogram(position = \"identity\", alpha = 0.5, bins = 30) +\n    #scale_x_log10() +\n    labs(title = paste(\"Histogram of\", var, \"partitioned by Diabetes_binary (Log Scale)\"), x = var, y = \"Count\") +\n    theme_minimal()\n}\n\n# Function to generate boxplot for numeric variables\ngenerate_boxplot_numeric <- function(var) {\n  ggplot(df, aes(x = Diabetes_binary, y = df[[var]], fill = Diabetes_binary)) +\n    geom_boxplot(alpha = 0.5) +\n    scale_y_log10() +\n    labs(title = paste(\"Boxplot of\", var, \"partitioned by Diabetes_binary\"), x = \"Diabetes_binary\", y = var) +\n    theme_minimal()\n}\n\n# Function to generate bar plot for factor variables with more than 3 levels\ngenerate_histogram_factor <- function(var) {\n  df |>\n    group_by(!!sym(var), Diabetes_binary) |>\n    \n    summarise(count = n(), .groups = \"drop\") |>\n    \n    group_by(!!sym(var)) |>\n    \n    mutate(\n      percentage = count / sum(count) * 100,\n      label = paste0(sprintf(\"%.1f\", percentage), \"%\")\n    ) |>\n    \n    ggplot(aes_string(x = var, y = \"count\", fill = \"Diabetes_binary\")) +\n    geom_bar(position = \"stack\", stat = \"identity\", alpha = 0.5) +\n    geom_text(aes(label = label), position = position_stack(vjust = 0.5), color = \"black\") +\n    labs(title = paste(\"Bar Plot of\", var, \"partitioned by Diabetes_binary\"), x = var, y = \"Count\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n}"
  },
  {
    "objectID": "EDA.html#generate-plots",
    "href": "EDA.html#generate-plots",
    "title": "ST558 Final Project EDA - Lee Worthington",
    "section": "Generate plots",
    "text": "Generate plots\n\n# Generate heatmaps for factor variables with up to 3 levels\nfor (var in factor_vars_heatmap) {\n  print(generate_heatmap(var))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Generate histograms for factor variables with more than 3 levels\nfor (var in factor_vars_histogram) {\n  print(generate_histogram_factor(var))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n# Generate histograms and box-plots for numeric variables with log scale on x-axis\nfor (var in numeric_vars) {\n  print(generate_histogram_numeric(var))\n  print(generate_boxplot_numeric(var))\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBased on the plots above, these are my main conclusions\n\nThe data looks complete and there are no obvious issues that pop out to me\nAlmost all the potential predictors look relevant, based on how either the heatmaps or plots are very lopsided/skewed depending on the factor levels"
  },
  {
    "objectID": "Modeling.html",
    "href": "Modeling.html",
    "title": "ST558 Final Project Model Fitting - Lee Worthington",
    "section": "",
    "text": "Setup environment and read data\n\n# load libraries\nlibrary(tidyverse)\nlibrary(GGally)\nlibrary(caret)\nlibrary(corrplot)\nlibrary(reshape2)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(scales)\nlibrary(knitr)  # For rendering tables in Quarto\n\n# set seed\nset.seed(1)  \n\n\n# Read in the data https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset/\ninput_data <- read_csv(\n  'diabetes_binary_health_indicators_BRFSS2015.csv',\n  show_col_types = FALSE\n)\n\n\n\nData prep\n\n# Data cleanup\ndf <- input_data |>\n  mutate(\n    Diabetes_binary = factor(Diabetes_binary, levels = c(0, 1), labels = c(\"No\", \"Yes\")), # slightly inconsistent here, but caret seems to expect yes = 1\n    \n    HighBP = factor(HighBP, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    HighChol = factor(HighChol, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    CholCheck = factor(CholCheck, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    Smoker = factor(Smoker, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    Stroke = factor(Stroke, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    HeartDiseaseorAttack = factor(HeartDiseaseorAttack, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    PhysActivity = factor(PhysActivity, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    Fruits = factor(Fruits, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    Veggies = factor(Veggies, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    HvyAlcoholConsump = factor(HvyAlcoholConsump, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    AnyHealthcare = factor(AnyHealthcare, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    NoDocbcCost = factor(NoDocbcCost, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    GenHlth = factor(GenHlth, levels = c(1, 2, 3, 4, 5), labels = c(\"Exc\", \"VGood\", \"Good\", \"Fair\", \"Poor\")),\n    \n    DiffWalk = factor(DiffWalk, levels = c(0, 1), labels = c(\"N\", \"Y\")),\n    \n    Sex = factor(Sex, levels = c(0, 1), labels = c(\"F\", \"M\")),\n    \n    Age = factor(\n      Age, \n      levels = 1:13, \n      labels = c(\"18-24\", \"25-29\", \"30-34\", \"35-39\", \"40-44\", \"45-49\", \"50-54\", \"55-59\", \"60-64\", \"65-69\", \"70-74\", \"75-79\", \"80+\")\n    ),\n    \n    Education = factor(\n      Education, \n      levels = 1:6, \n      labels = c(\n        \"None/Kinder\", \"Elem\", \"Some HS\", \n        \"HS Grad\", \"Some College\", \"College Grad\"\n      )\n    ),\n    \n    Income = factor(\n      Income, \n      levels = 1:8, \n      labels = c(\n        \"<$10k\", \"$10-15k\", \"$15-20k\", \"$20-25k\", \n        \"$25-35k\", \"$35-50k\", \"$50-75k\", \">$75k\"\n      )\n    )\n  )\n\n# Split dummy data and drop original fields\ntrain_index <- createDataPartition(df$Diabetes_binary, p = 0.7, list = FALSE)\ntrain_data <- df[train_index, ]\ntest_data <- df[-train_index, ]\n\n# check results\ndim(df)\n\n[1] 253680     22\n\ndim(train_data)\n\n[1] 177577     22\n\ndim(test_data)\n\n[1] 76103    22\n\n\n\n# Fit logistic model with every predictor\nlogistic_model <- train(\n  Diabetes_binary ~ .,\n  data = train_data,\n  method = \"glm\",\n  family = \"binomial\",\n  metric = \"logLoss\",\n  preProcess = c(\"center\", \"scale\"),\n  trControl = trainControl(method = \"cv\", number = 5)\n)\n\n# Print training model fit\nlogistic_model\n\nGeneralized Linear Model \n\n177577 samples\n    21 predictor\n     2 classes: 'No', 'Yes' \n\nPre-processing: centered (45), scaled (45) \nResampling: Cross-Validated (5 fold) \nSummary of sample sizes: 142062, 142063, 142061, 142061, 142061 \nResampling results:\n\n  Accuracy   Kappa    \n  0.8651571  0.1912069\n\nsummary(logistic_model)\n\n\nCall:\nNULL\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.5563  -0.5382  -0.3068  -0.1536   3.6301  \n\nCoefficients:\n                         Estimate Std. Error  z value Pr(>|z|)    \n(Intercept)             -2.499792   0.011959 -209.028  < 2e-16 ***\nHighBPY                  0.352708   0.008722   40.441  < 2e-16 ***\nHighCholY                0.261730   0.008047   32.527  < 2e-16 ***\nCholCheckY               0.226773   0.015440   14.687  < 2e-16 ***\nBMI                      0.381605   0.007225   52.819  < 2e-16 ***\nSmokerY                 -0.023837   0.007906   -3.015 0.002569 ** \nStrokeY                  0.027816   0.005918    4.700 2.60e-06 ***\nHeartDiseaseorAttackY    0.075230   0.006206   12.121  < 2e-16 ***\nPhysActivityY           -0.022712   0.007393   -3.072 0.002126 ** \nFruitsY                 -0.008297   0.007901   -1.050 0.293643    \nVeggiesY                -0.013835   0.007437   -1.860 0.062829 .  \nHvyAlcoholConsumpY      -0.181739   0.010726  -16.944  < 2e-16 ***\nAnyHealthcareY           0.019350   0.008666    2.233 0.025551 *  \nNoDocbcCostY             0.001925   0.007656    0.252 0.801425    \nGenHlthVGood             0.343304   0.019241   17.842  < 2e-16 ***\nGenHlthGood              0.659610   0.018022   36.601  < 2e-16 ***\nGenHlthFair              0.617502   0.014058   43.926  < 2e-16 ***\nGenHlthPoor              0.440976   0.010831   40.715  < 2e-16 ***\nMentHlth                -0.015783   0.007527   -2.097 0.036000 *  \nPhysHlth                -0.032258   0.008398   -3.841 0.000122 ***\nDiffWalkY                0.048412   0.007580    6.387 1.69e-10 ***\nSexM                     0.128121   0.008017   15.981  < 2e-16 ***\n`Age25-29`               0.041121   0.031215    1.317 0.187725    \n`Age30-34`               0.126094   0.034092    3.699 0.000217 ***\n`Age35-39`               0.237921   0.035859    6.635 3.25e-11 ***\n`Age40-44`               0.323149   0.037948    8.516  < 2e-16 ***\n`Age45-49`               0.393194   0.041143    9.557  < 2e-16 ***\n`Age50-54`               0.514946   0.046343   11.112  < 2e-16 ***\n`Age55-59`               0.584471   0.049482   11.812  < 2e-16 ***\n`Age60-64`               0.676783   0.050993   13.272  < 2e-16 ***\n`Age65-69`               0.720518   0.050305   14.323  < 2e-16 ***\n`Age70-74`               0.641152   0.043909   14.602  < 2e-16 ***\n`Age75-79`               0.522055   0.037130   14.060  < 2e-16 ***\n`Age80+`                 0.489432   0.038448   12.730  < 2e-16 ***\nEducationElem            0.010902   0.030599    0.356 0.721634    \n`EducationSome HS`      -0.002309   0.046285   -0.050 0.960208    \n`EducationHS Grad`      -0.037840   0.104375   -0.363 0.716947    \n`EducationSome College` -0.024833   0.108208   -0.229 0.818483    \n`EducationCollege Grad` -0.069766   0.119647   -0.583 0.559826    \n`Income$10-15k`         -0.009085   0.008913   -1.019 0.308072    \n`Income$15-20k`         -0.017543   0.009941   -1.765 0.077616 .  \n`Income$20-25k`         -0.028525   0.010809   -2.639 0.008318 ** \n`Income$25-35k`         -0.052392   0.011979   -4.374 1.22e-05 ***\n`Income$35-50k`         -0.084993   0.013656   -6.224 4.85e-10 ***\n`Income$50-75k`         -0.100975   0.014805   -6.820 9.08e-12 ***\n`Income>$75k`           -0.200728   0.018742  -10.710  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 143396  on 177576  degrees of freedom\nResidual deviance: 112487  on 177531  degrees of freedom\nAIC: 112579\n\nNumber of Fisher Scoring iterations: 7"
  }
]